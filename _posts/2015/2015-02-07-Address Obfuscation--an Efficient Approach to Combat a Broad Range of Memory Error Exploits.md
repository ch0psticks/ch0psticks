---
layout: post
permalink: /post/AddressObfuscation
tags: [Randomization, ROP, Security]
categories: [Research]
---


本文发表在 2003年的USENIX Security Symposium上[^AddressObfuscation]

### 1. 简述

文章较早，但在现有ASLR的基础上提出了：

- 通过stack padding的方式实现stack layout radomization
- 通过随机的多分配空间，实现heap randomization
- 此外，还有Permute the order of variables/routines（改变变量和函数的顺序）

### 2. 实现

对于上述中的1和2:

1. stack randmoization是通过修改`sub esp, #inst`中的`#inst`实现的，即`sub esp, #inst + random_offset`，同时修改栈内变量访问的offset即可。问题是仅对有变量的函数进行随机。同时有可能出错，所以采用的是略保守的修改。
2. heap randomization则是通过生成一个malloc函数的wapper函数，在分配空间时，分配完成后再分配随机大小的空间——算是栅栏吧。使攻击者难以预测后面数据的offset。

### 3. 评估

1. 评估了栈随机化的程度
2. 针对各种类型攻击进行了针对性分析。

[^AddressObfuscation]: S. Bhatkar, D. C. DuVarney, and R. Sekar, “Address Obfuscation: An Efficient Approach to Combat a Broad Range of Memory Error Exploits.,” in USENIX Security, 2003, vol. 3, pp. 105–120.


