---
layout: post
permalink: /post/security-trends
tags: [Trend, Security]
categories: [Methodology, Research]
---

## 1. 安全趋势

### 1.1 关于趋势的思考维度

安全的趋势和方向产生的内因主要有两个：新场景、新技术。新场景会引入一些新的安全问题或者引发安全交付形态的革命；新技术则会在性能、效果上颠覆传统技术，甚至取而代之。


**技术方面**：在新场景、新技术的催生下，当前创业公司或新解决方案的出发点大致为：

1. 用新技术解决老场景中的问题。比如用机器学习来检测恶意软件；用人工智能来加速fuzzing、找漏洞；基于人工智能的精准社会工程学攻击（钓鱼邮件）。
2. 用已有技术解决新场景中的问题。比如，识别和管控客户网络中的IoT资产、移动设备等；云上业务安全；IoT僵尸网络。
3. 新技术、新场景、新问题。一些新场景或新兴问题确实只能用一些新技术来解决。这里没想到太合适的例子，或许用AI+大数据等来检测电信欺诈算一个。


**产品方面**：上述变革，反映到具体产品上，则其价值在于：

1. 新的业务形态、新的交付形式
2. 更好的解决问题的能力
3. 商业模式变化

**客户需求**：基于新场景、新技术，客户也会提出新需求（解决问题的能力等、新技术的引入和演进战略等）。客户需求也会对产品特性、功能、呈现形式有很大影响。从客户的角度出发，其相对比较关注：

- 威胁：是否能防？放不住了能否检测得到？检测的结果能否看得懂、说的清？能否进行取证、溯源，以及修复？
- 资产：看得见、管得住
- 合规：能够满足等保、上级单位监管、安全审计等。
- ...

### 1.2 安全理念

这里列几个目前公认的安全理念或共识。后续涉及的产品和技术大多都会基于这些理念、共识出发。

#### 1.2.1 自适应安全

Gartner在2014年给出了如下图所示的自适应安全模型（看上去和PDCA环类似）。其强调防御、检测、响应、预测是一个持续性的过程，而不应当仅仅局限在防御阶段。在2016年，Gartner强调，当前应当重点聚焦于检测和响应这两个环节[^gartner-summit]。 需要注意的是，在自适应体系中，Monitor&Analytics是核心也是基础。
> 当前内网态势感知、SOC、SIEM类产品也恰好是更多的满足一需求。

[^gartner-summit]: Eric Ahlm. To the Point: Navigating the Chaotic World of Security Analytics.

![](/media/images/15123273371025.jpg)




#### 1.2.2 攻击链与纵深检测

攻击链(Kill-chain)是美国军火公司洛克希德马丁在2013年提出的攻击模型[^killchain]。其大致流程如下。实际中，并不一定完全是这套流程，但其基本上覆盖了攻击的各个环节，已被广为认可。
![](/media/images/15123274031999.jpg)


[^killchain]: https://en.wikipedia.org/wiki/Kill_chain

> 当前基于数据分析的检测产品，会采用这一理论体系来定义每一阶段的检测对象——黑客可能进行的活动。例如，黑客进入内网后需要进一步横向移动，来找到最终目标，那么通过枚举横向移动方式、分别进行检测，来识别恶意活动。
> 该模型也对应于Cisco、Dambella等公司解决方案的安全理念——即在威胁可能出现的每一个阶段都进行分析，从可疑开始持续追踪，最终确认威胁。


#### 1.2.3 企业安全边界变得模糊

随着IT基础设施的变迁，业务云化，移动办公、BYOD、IOT等新场景的出现，传统的企业安全边界已经变得非常模糊，基于边界的防护体系已难以有效保护企业业务和用户的安全。如下图所示。
![-w600](/media/images/15123274625158.jpg)



#### 1.2.4 大数据、人工智能技术逐渐应用于安全领域

用数据分析、人工智能等技术来解决特定的安全问题，已经被接受。如传统厂商赛门铁克、趋势科技等均采用机器学习算法等辅助做恶意软件检测、关系分析等；IBM Watson则从互联网上读取大量的安全信息，进行处理分析形成安全威胁情报。在行为分析方面，也有很多公司探索。
![-w600](/media/images/15123274992685.jpg)





在大火的态势感知平台或者下一代SIEM、下一代SOC中，Security Analytics powered by AI更是必备。




### 1.3 安全趋势与方向

下表是Gartner近两年给出的TOP趋势排行。在实际实施过程中，这类技术是存在交集的，很难完全划分。如，用户实体行为分析技术（UEBA）也可以是网络流量分析（NTA）实现。

|  | 2017 | 2016 |
| --- | :-: | :-: |
| 1 | 云工作负载保护平台（CWPP） | **云访问安全代理技术(CASB)** |
| 2 | 远程浏览器技术 | **端点检测和响应（EDR）**  |
| 3 | 欺骗技术 |  **基于非签名方法的终端防御技术** |
| 4 |  **端点检测和响应（EDR）** | **用户和实体行为分析技术（UEBA）** |
| 5 | **网络流量分析（NTA）** | 微隔离和流量可视化技术　 |
| 6 | 管理检测和响应（MDR） | DevOps的安全测试技术 |
| 7 | 微隔离（Microsegmentation） | **情报驱动的安全运营中心业务流程解决方案** |
| 8 |  软件定义边界（SDP） | 远程浏览器技术 |
| 9 |  **云访问安全代理技术(CASB)** | 欺骗技术 |
| 10 | 面向DevSecOps的OSS安全扫描和软件组成分析技术 | 普适信任服务技术 |
| 11 |  容器安全 | NA |




## 2. 典型应用案例

主要列举一些关注过的安全厂商，经可能覆盖一些重要的安全趋势与方向。方向比较发散，故暂时不做过于深入介绍。

### 2.1 基于机器学习的恶意软件检测——Cylance

Cylance号称具备下一代反病毒技术——无特征、基于机器学习的检测技术。2012年，Cylance 成立。2016年6月，互联网安全初创企业 Cylance 获得了 1 亿美元的 D 轮融资，截止到现在总共融资1.77亿美金。

- 定位：终端安全——基于机器学习的下一代反病毒厂商，聚焦于文件安全。
- 产品特点：不依赖于特征库（signature）或行为分析(即沙箱、HIPS等）。
- 解决的问题：传统杀毒软件在文件检测上依赖于特征库、容易被绕过；基于行为的分析往往在攻击发生后。
- Cylance的解决方法：文件是根源，提供基于大数据、机器学习的文件安全性检测，辅助以运行时内存防护。

核心技术——CylanceINFINITY Engine：常规的机器学习套路来做。包括样本收集、特征信息提取、学习、分类判定等。其中分类判定阶段，Cylance采用的基于统计的机器学习模型，最终会对待判定文件输出一个可信度的得分，根据可信度的得分划分级别，确定后续相应的处理措施（禁止、隔离、监控、进一步分析）。此外，管理员可以调整安全严格级别，来设置评判的标准。相对于传统检测方法直接给出是或否的判定结果而言，相对更加灵活。

这块Cylance有相关的专利[^cylance-1][^cylance-2][^cylance-3]和学术论文[^cylance-00][^cylance-01]。同类厂商还有：Deep Instinct、Invincea


[^cylance-1]: Static feature extraction from structured files
[^cylance-2]: Wavelet decomposition of software entropy to identify malware[^cylance-1]: Recurrent neural networks for malware analysis 
[^cylance-3]: Automated system for generative multimodel multiclass classification and similarity analysis using machine learning 
[^cylance-00]: Suspiciously Structured Entropy:Wavelet Decomposition of Software Entropy Reveals Symptoms of Malware in the Energy Spectrum
[^cylance-01]: Wavelet decomposition of software entropy reveals symptoms of malicious code

**参考之处**：基于当前海量的样本数据，研究基于机器学习的检测引擎。

### 2.2 数据分析、流量分析公司--Vectra

通过旁路部署的形式进行流量分析、检测威胁。其出发点是传统的基于边界的防御、检测，以及基于SIEM的日志分析的解决方案存在一个空档期，即攻击者突破边界后，便变得畅通无阻，直到攻击完成很久之后才会被发现入侵事件。如下图所示。

![-w600](/media/images/15123275961200.jpg)


**Vectra的主要出发点：**以攻击者的角度进行防御，即针对黑客可能会采用的攻击手法，一一进行检测。在某一阶段属于事后检测，但整体上则能够在攻击过程中发现入侵行为。例如：

- 识别内网慢速扫描、爆破等横向移动攻击。
- 对外的DoS、Web攻击、扫描、爆破等
- C&C、垃圾邮件、广告、挖矿等恶意行为
- 。。。

作为内网流量分析产品，Vectra也具备用户实体行为异常分析的能力。如在专利[^vectra]中，Vectra给出了一个基于内网访问关系图的异常检测方法。基于netflow数据，形成内网的访问关系，进而建立访问关系图，然后基于图进行社区聚类，最后通过判断每个主机跨社区访问的程度来发现异常。

[^vectra]: System for Implementing Threat Detection using Daily Network Traffic Community Outliers

此外，还有其它一些公司，如DarkTrace、ThetaRay等，也提供类似的基于数据分析的安全平台。这类产品通常都会采用传统的统计、概率、关联分析等算法与机器学习算法相结合的方式，来发现行为异常，流量异常，识别威胁。

**参考之处**：无论是传统的内网还是云上主机，都可以考虑基于流量、数据的分析手法来识别传统的基于规则难以发现的攻击行为。



### 2.3 用户、实体行为异常分析——UEBA

用户、实体异常产生的原因有两方面，一方面是用户帐号泄露、主机被控制等引发的行为异常。
另一方面是用户本身属于内鬼，主动窃取数据、攻击其它主机等，表现出的异常。因此，UEBA的主要目的在于基于对账户活动日志、登录方式、主机流量等的关联分析，识别出异常行为，进一步的关联到其具体应用场景，判定是哪一类安全问题。

*注：这类异常检测方法在实际中可能存在场景过于复杂，误报等问题*

UEBA的产品主要有两种产品形态：

- 单独的UEBA产品(Niara、E8 Security、Fortscale等）
- 已有系统上（如SIEM、身份认证管理等）增加或整合UEBA分析能力。（IBM Qradar等）

![-w600](/media/images/15123276514507.jpg)



#### 用户和实体行为分析（UEBA）厂商--Niara

Niara 是用户和实体行为分析（UEBA）安全市场的提供商之一。**Niara通过采用用户行为分析的技术，解决如下场景的问题，用户帐号或主机失陷检测、恶意内部用户检测、员工离职检测、高价值资产保护等。**

主打产品为Niara Analyzer，Niara Analyzer主要通过分析IT系统日志、告警信息、网络流量等数据源，采用监督学习、半监督学习、无监督学习等刻画实体（用户、ip地址、主机等实体）行为，对用户行为按威胁程度进行打分、提供可视化的用户行为之间的关系图，并且提供取证机制[^niara-1][^niara-2]。下图是一些支持的输入数据源。

![](/media/images/15123276926141.jpg)



目前公司已被HP整合到ARUBA下的ClearPass安全产品。ClearPass是hp的网络接入管理系统，主要解决Mobile和IOT设备接入网络的场景。Niara的方案主要是采用大数据挖掘的方式，做企业内部安全、IOT设备的异常监测。

此外，E8 Security、国内的翰思都有做这类UEBA的产品。

**参考之处：**在主机行为异常检测、账户异常等方面，都可以参考这类技术。通过建立用户行为、主机行为的基线，识别异常行为；在此基础上尝试使用Feature decompression等再识别是哪一类威胁。



[^niara-1]: https://www.niara.com/docs/cs-energy.pdf
[^niara-2]: https://spark-summit.org/2017/speakers/dr-jisheng-wang/




### 2.4 云安全服务、CASB

CASB即Cloud Access Security Broker在2012年提出，并被Gartner认定为2016年十大信息安全技术之首[^top10-sec]。Gartner预测从2012年不到1%的企业使用CASB，到2020年会有85%的大型企业会使用CASB，由此可见CASB将成为业务云化趋势下的刚需。
Gartner指出了CASB的四大功能，分别是：可见性（Visibility），合规性（Compliance）,数据安全（Data Security）以及威胁防护（Threat Protecction）。
● 可见性：CASB提供对企业内使用云服务的使用人员、客户端设备以及使用情况，提供集中化视图，对异常行为进行检测、阻断和记录，避免了Shadow IT的存在。
● 合规性：CASB帮助企业IT系统往云上迁移后，仍然能满足合规性要求，并对云服务商进行信任评级、提供平内容监控、设计日志等功能。
● 数据安全：CASB结合了人员、设备、内容和应用多个维度，提供DLP、Encryption、 Tokenization等数据安全保护，防止云端数据泄露。
● 威胁防护： CASB可以提供云服务商基础设施威胁防护之外的一些关乎企业用户自身的特定威胁，诸如账户劫持问题。CASB可以帮助企业对进出云上的数据、用户访问云服务资源行为进行监控，及时发现威胁并且做出防御。

[^top10-sec]: 2016那年十大信息安全技术：http://www.gartner.com/newsroom/id/3347717
[^top10-sec-cns]: 解读Gartner 2016年十大信息安全技术: http://www.freebuf.com/articles/security-management/107149.html


#### 云安全服务厂商——Zscaler

[Zscaler](https://www.zscaler.com/)主要提供基于云的安全服务，即Security as a service。Zscaler在web安全防护、云安全服务领域处于全球领先地位。其核心价值在于解决业务上云、移动办公等导致安全边界模糊、进而引发的安全问题。

Zscaler通过将流量牵引至其平台，在用户和云端资源交互、访问互联网等过程中进行访问控制、威胁过滤、数据管理，进而保证用户和云上业务的安全。


<img width="550"  src="/media/images/15123277937157.jpg"/>



<!--![-w600](/media/images/15123277937157.jpg)-->



其提供的安全能力包括：

<img width="550"  src="/media/images/15123278560920.jpg"/>




**参考之处**： 将当前的安全能力整合为云安全服务平台，为企业提供云化的服务。



#### DNS安全服务厂商——Cisco Umbrella(OpenDNS)

[Cisco Umbrella](https://umbrella.cisco.com/)是Cisco收购OpenDNS后，整合出来的基于DNS的安全产品。其提供的安全能力主要在于两个方面：
**
- 与Zscaler类似，直接提供云安全服务（Security as a service）。（OpenDNS是全球比较大的DNS服务提供者）。Cisco Umbrella通过将流量牵引到指定的DNS服务器上，然后对所有的DNS请求进行分析、检测，进而提供内容过滤、访问控制、威胁防护等功能。同时，用户可以在云端dashboard上，查看网络活动、日志等，也可以实现按用户、按内容类型、威胁类型进行过滤。
- 此外，Cisco也将Cisco Umbrella作为其安全解决方案的一个重要基础能力。主要通过威胁情报的行为，为自己的产品和第三方产品服务。在很多网络攻击中，DNS请求这一步是必须的，如回调、C2等。

Cisco Umbrella的核心竞争力在于云端对DNS数据的分析、运营，识别其中的恶意域名、关联到的IP等。其理念是learn——分析DNS数据，see——提供对任何设备、任何端口的DNS活动记录，block——管控和威胁防御。类似的厂商有Nominum、Mominet等。

**参考之处**：基于DNSPod、端点DNS数据来提供安全能力。


此外，还有一些提供Security as a service的厂商，如Okta则提供身份统一认证、管理；国内厂商Locket则提供云端数据加密服务等等。


### 2.5 威胁情报服务

威胁情报最能体现厂商对数据的安全运营能力——基于已有数据能发现哪些安全问题、时效性、准确性如何。

Gartner定义的威胁情报（Threat Intelligence，以下简称TI）是关于已出现或新的资产威胁和危险的、基于证据的信息，包括情景、机制、指标、影响和可行建议，可用来通知企业针对相关威胁或危险做出决策。

**代表：**威胁情报的能力典型代表有Cisco Talos、IBM Xforce、Google VirusTotal，国内的有Janus（移动数据威胁情报平台）、threatbook(微步在线）等。其中IBM XForce的一部分能力源于IBM Watson[^xforce]。

**价值：**威胁情报服务主要为SOC(Security operating center)输出一些情报，如黑IP、恶意URL、恶意文件hash等。如下图所示。

![](/media/images/15123279175829.jpg)



实际上，当前各家威胁情报服务还具备，IP、域名等的状态变化，实体之间的关系。比如，IBM Xforce可以展示出指定IP历史上的恶意活动记录。

此外，当前威胁情报也被安全人员广泛用于威胁发现。这是一种基于假设和线索的追踪技术。

### 2.6 运行时应用自保护Runtime Application Self-Protection（RASP）


Gartner在2014年应用安全报告里将 RASP 列为应用安全领域的关键趋势，认为应用程序不应该依赖外部组件进行运行时保护，而应该具备自我保护的能力，也即建立应用运行时环境保护机制。

**RASP主要通过修改运行时环境，或者直接植入代码方式保护应用安全，相当于应用把安全“外包”给RASP。**RASP一般运行在应用程序的内部，它的安全保护控制点通常放在应用程序和其他系统的交互连接点上，包括和用户、数据库、网络以及文件系统的连接点，从而能实时监测并拦截漏洞攻击。RASP 的亮点在于「自我保护」，能够在运行时结合上下文采取相应的保护方案。

目前RASP更多的是针对服务器应用程序，尤其是Java组件。具体应用场景如下：

- 通过在应用程序中注入代码探针采集信息，综合判断应用程序的安全情况。
- 扫描应用程序使用的开源组件安全性分析，对不安全的组件提供防御处理。
- 多层防御，实时监控分析应用层的攻击行为。
- 在应用中植入代码，可分析应用不同环节的性能使用情况，优化应用。
- DevOps领域的安全防御技术。



#### RASP厂商——Contrast Enterprise

Contrast 产品通过在客户应用中植入代码或修改运行时环境库等方式，结合策略集中管理平台，给客户的应用提供安全。相当于客户在把应用的安全外包给Contrast Security。Contrast Enterprise的产品主要用于开发环境环节中。

通过监控 Java 和.NET 代码运行、数据流、配置等信息，迅速找出高危漏洞，而且不会出现误报。Contrast能够将漏洞准确定位到代码层，这就减少了很多推测工作，而与应用环境密切相关的指导则有助于快速修复问题。系统结构如下所示。
![-w500](/media/images/15123279625846.jpg)

、



此外，还有tCell、国内厂商OneRASP也提供基于RASP的服务。百度也开源了其开发的RASP--OpenRASP[^baidu-rasp]

[^baidu-rasp]: https://rasp.baidu.com/



**参考之处**：对不安全组件（插件）的监控：RASP是一种细粒度的监控和防护方式。当前终端应用程序、web服务在开发的过程中往往会使用大量的第三方组件或库，而这些库的安全性是难以评测的，RASP则提供了这一样一种能力——在程序运行的过程中，持续监控运行情况、分析、检测，如果不可信的组件存在安全问题，则可以即使的阻止、报警，发现不可信组件中的漏洞或后门攻击。此外，基于用户定制的安全策略，RASP也可以做到对应用程序中组件的细粒度的隔离（组件沙箱）来提升应用程序或服务的安全能力。

这类服务可以直接作为云应用，由用户直接选择。




